# 登录认证

## 门店登录

>步骤1. 查询业务服务器

`
POST {{cloud_host}}/public/v1/account/router
`
> 请求参数:

<table>
    <tr>
        <th style="width:150px;">请求参数</th>
        <th>必须</th>
        <th>类型</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>account</td>
        <td>是</td>
        <td>string</td>
        <td>账号</td>
    </tr>
</table>

> 返回参数:
<table>
    <tr>
        <th style="width:150px;">请求参数</th>
        <th>类型</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>appId</td>
        <td>string</td>
        <td>业务系统AppId</td>
    </tr>
    <tr>
        <td>account</td>
        <td>string</td>
        <td>账号</td>
    </tr>
    <tr>
        <td>domain</td>
        <td>string</td>
        <td>业务服务器域名</td>
    </tr>
    <tr>
        <td>contextPath</td>
        <td>string</td>
        <td>业务服务器contextPath，完整的请求请使用 域名+contextPath 拼在一起</td>
    </tr>
</table>

>步骤2. 业务服务器登录

`
POST /public/v1/auth/user-login
`

> 请求参数: 

<table>
    <tr>
        <th style="width:150px;">请求参数</th>
        <th>必须</th>
        <th>类型</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>account</td>
        <td>是</td>
        <td>string</td>
        <td>账号</td>
    </tr>
    <tr>
        <td>password</td>
        <td>是</td>
        <td>string</td>
        <td>密码</td>
    </tr>
    <tr>
        <td>client</td>
        <td>是</td>
        <td>Client</td>
        <td>客户端, 见系统参数，暂时用apad代表安卓平板</td>
    </tr>
    <tr>
        <td>device</td>
        <td>是</td>
        <td>string</td>
        <td>设备，设备描述，如华为S40平板v7.1</td>
    </tr>
</table>

> 返回值

<table>
    <tr>
        <th style="width:150px;">返回参数</th>
        <th>类型</th>
        <th>说明</th>
        <th>备注</th>
    </tr>
    <tr>
        <td>appId</td>
        <td>string</td>
        <td>系统AppId</td>
        <td>-</td>
    </tr>
    <tr>
        <td>user</td>
        <td>object</td>
        <td>用户</td>
        <td>-</td>
    </tr>
    <tr>
        <td>token</td>
        <td>string</td>
        <td>TOKEN,后续请求需要使用</td>
        <td>-</td>
    </tr>
    <tr>
        <td>refreshToken</td>
        <td>string</td>
        <td>刷新TOKEN,当token失效时，可使用refreshToken刷新token</td>
        <td>-</td>
    </tr>
</table>

## 刷新token
`
POST /public/v1/auth/user-refresh
`

> 请求参数:

<table>
    <tr>
        <th style="width:150px;">请求参数</th>
        <th>必须</th>
        <th>类型</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>refreshToken</td>
        <td>是</td>
        <td>string</td>
        <td>刷新token</td>
    </tr>
</table>

>下方接口暂时未启用

## 退出登录

```
POST /user/v1/logout
```

## 发送验证码
```
POST /auth/v1/captcha
```
> 请求参数:

<table>
    <tr>
        <th style="width:150px;">请求参数</th>
        <th>必须</th>
        <th>类型</th>
        <th>说明</th>
    </tr>
    <tr>
        <td>appId</td>
        <td>是</td>
        <td>string</td>
        <td>AppId</td>
    </tr>
    <tr>
        <td>mobile</td>
        <td>是</td>
        <td>string</td>
        <td>手机</td>
    </tr>
    <tr>
        <td>category</td>
        <td>是</td>
        <td>string</td>
        <td>验证码类型: 此处固定为: Login</td>
    </tr>
</table>


## 查看验证码(临时)
```
GET /auth/v1/captcha
```
